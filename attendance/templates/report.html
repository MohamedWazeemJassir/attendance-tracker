{% extends "base.html" %}
{% block content %}

<h2>{{ report_title }}</h2>


<form method="get" style="margin-bottom:15px;">
  <label>Date:</label>
  <input type="date" name="date" value="{{ date_value }}">

  <label>Student:</label>
  <input type="text" name="student" value="{{ student_query }}" placeholder="Student name">

  <label>Class:</label>
  <input type="text" name="class" value="{{ class_query }}" placeholder="e.g. 10-A">

  <button type="submit">Filter</button>
</form>

<table border="1">
  <tr>
    <th>Student</th>
    <th>Class</th>
    <th>Date</th>
    <th>Status</th>
    {% if role == "TEACHER" %}
      <th>Action</th>
    {% endif %}
  </tr>


  {% for row in report_data %}
  <tr>
    <td>{{ row.student.name }}</td>
    <td>{{ row.student.class_name }}</td>
    <td>{{ row.date|date:"d-m-Y" }}</td>
    <td>
      {% if row.attendance %}
        {{ row.attendance.status }}
      {% else %}
        Not Marked
      {% endif %}
    </td>

    {% if role == "TEACHER" %}
      <td>
        {% if row.can_edit %}
          <a href="{% url 'edit_attendance' row.attendance.id %}">Edit</a>
        {% else %}
          â€”
        {% endif %}
      </td>
    {% endif %}
  </tr>

  {% empty %}
  <tr>
    <td colspan="4">No records found.</td>
  </tr>
  {% endfor %}
</table>

{% endblock %}
